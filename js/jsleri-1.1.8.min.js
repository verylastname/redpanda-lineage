!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.jsleri=e():t.jsleri=e()}(window,function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=2)}([function(t,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(e){return"function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?t.exports=r=function(t){return n(t)}:t.exports=r=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":n(t)},r(e)}t.exports=r},function(t,e){function n(){return t.exports=n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},n.apply(this,arguments)}t.exports=n},function(t,e,n){"use strict";n.r(e),n.d(e,"version",function(){return a}),n.d(e,"noop",function(){return c}),n.d(e,"Keyword",function(){return g}),n.d(e,"Regex",function(){return x}),n.d(e,"Token",function(){return R}),n.d(e,"Tokens",function(){return q}),n.d(e,"Sequence",function(){return S}),n.d(e,"Choice",function(){return m}),n.d(e,"Repeat",function(){return O}),n.d(e,"List",function(){return b}),n.d(e,"Optional",function(){return v}),n.d(e,"Ref",function(){return j}),n.d(e,"Prio",function(){return w}),n.d(e,"THIS",function(){return V}),n.d(e,"Grammar",function(){return k}),n.d(e,"EOS",function(){return C});var r=n(1),o=n.n(r),i=n(0),s=n.n(i),a="1.1.8",c=function(){},u=/^\s+/,p=/^\w+/,l=/\s+/,f=function(t){return"function"==typeof t},h=function(t){return"string"==typeof t&&0!==t.indexOf("^",0)&&(t="^"+t),new RegExp(t)},d=function(t,e){return t.length<e.length},y=function(t,e,n,r){var o=new B,i=function(t,n,r){r>o.pos&&o.empty(),n.end=r,n.str=e.substring(n.start,n.end),t.push(n)},s=function t(n,s,a,c,p){var l,f,h,d,y,_,j,k,V;if(l=e.substring(s).replace(u,""),k=new P(n,e.length-l.length),o.setModeRequired(k.start,p),n instanceof m){for(V=new M(!1,k.start),d=0,y=n.elements.length;d<y;d++)j=[],(h=t(n.elements[d],k.start,j,c,!0)).isValid&&h.pos>V.pos&&(k.children=j,V=h);return V.isValid&&i(a,k,V.pos),V}if(n instanceof g)return _=l.match(r),(f=n.ignCase?Boolean(_&&_[0].toLowerCase()===n.keyword.toLowerCase()):Boolean(_&&_[0]===n.keyword))?i(a,k,k.start+n.keyword.length):o.update(n,k.start),new M(f,k.end||k.start);if(n instanceof b){for(s=k.start,d=0,y=0;(h=t(n.element,s,k.children,c,d<n.min)).isValid&&(s=h.pos,d++,(h=t(n.delimiter,s,k.children,c,d<n.min)).isValid);)s=h.pos,y++;return(f=!(d<n.min||n.max&&d>n.max||!n.opt&&d&&d==y))&&i(a,k,s),new M(f,s)}if(n instanceof v)return(h=t(n.element,k.start,k.children,c,!1)).isValid&&i(a,k,h.pos),new M(!0,k.end||k.start);if(n instanceof w){for(void 0===c._tested[k.start]&&(c._tested[k.start]=new M(!1,k.start)),d=0,y=n.elements.length;d<y;d++)j=[],(h=t(n.elements[d],k.start,j,c,!0)).isValid&&h.pos>c._tested[k.start].pos&&(k.children=j,c._tested[k.start]=h,c._tree[k.start]=j);return c._tested[k.start].isValid&&i(a,k,c._tested[k.start].pos),c._tested[k.start]}if(n instanceof x)return _=l.match(n._re),(f=Boolean(_))?i(a,k,k.start+_[0].length):o.update(n,k.start),new M(f,k.end||k.start);if(n instanceof O){for(s=k.start,d=0;(!n.max||d<n.max)&&(h=t(n.element,s,k.children,c,d<n.min)).isValid;d++)s=h.pos;return(f=d>=n.min)&&i(a,k,s),new M(f,s)}if(n instanceof E)return n._tested={},n._tree={},(h=t(n.element,k.start,k.children,n,!0)).isValid&&i(a,k,h.pos),h;if(n instanceof S){for(s=k.start,d=0,y=n.elements.length;d<y;d++){if(!(h=t(n.elements[d],s,k.children,c,!0)).isValid)return h;s=h.pos}return i(a,k,h.pos),h}if(n instanceof R)return(f=Boolean(0===l.indexOf(n.token)))?i(a,k,k.start+n.token.length):o.update(n,k.start),new M(f,k.end||k.start);if(n instanceof q){for(d=0,y=n.tokens.length;d<y;d++)if(0===l.indexOf(n.tokens[d]))return i(a,k,k.start+n.tokens[d].length),new M(!0,k.end);return o.update(n,k.start),new M(!1,k.start)}return n instanceof J?(void 0===c._tested[k.start]?(c._tested[k.start]=t(c.element,k.start,k.children,c,!0),c._tree[k.start]=k.children):k.children=c._tree[k.start],c._tested[k.start].isValid&&i(a,k,c._tested[k.start].pos),c._tested[k.start]):void 0}(t,0,n,t,!0),a=e.substring(s.pos).replace(u,"");return s.isValid&&a&&(s.isValid=!1),!o.required.length&&a&&(o.setModeRequired(s.pos,!0),o.update(C,s.pos)),s.expecting=o.getExpecting(),s.isValid||(s.pos=o.pos),s};function m(){var t=L.call(this,m,arguments);if(t)return t;this.elements=this.checkElements(this.args)}function g(t,e){var n=L.call(this,g,arguments);if(n)return n;t=this.args[0],e=this.args[1],this.keyword=t,this.ignCase=Boolean(e)}m.prototype=Object.create(L.prototype),m.prototype.constructor=m,g.prototype=Object.create(L.prototype),g.prototype.constructor=g;var b=function t(e,n,r,o,i){var a=L.call(this,t,arguments);if(a)return a;if(e=this.args[0],n=void 0===this.args[1]?new R(","):this.args[1],r=this.args[2],o=this.args[3],i=this.args[4],!(e instanceof L))throw"(Jsleri--\x3eList) first argument must be an instance of Jsleri; got "+s()(e);if("string"!=typeof n&&!(n instanceof L))throw"(Jsleri--\x3eList) second argument must be a string or instance of Jsleri; got "+s()(n);this.element=e,this.delimiter=n instanceof L?n:new R(n),this.min=void 0===r||null===r?0:r,this.max=void 0===o||null===o?null:o,this.opt=Boolean(i)};function v(t){var e=L.call(this,v,arguments);if(e)return e;if(!((t=this.args[0])instanceof L))throw"(Jsleri--\x3eOptional) first argument must be an instance of Jsleri; got "+s()(t);this.element=t}function w(){var t=L.call(this,w,arguments);return t||(this.elements=this.checkElements(this.args),new E(this))}function x(t,e){var n=L.call(this,x,arguments);if(n)return n;t=this.args[0],e=this.args[1],this.re=t,this._re=new RegExp("^"+t,e?"i":void 0)}function O(t,e,n){var r=L.call(this,O,arguments);if(r)return r;if(t=this.args[0],e=this.args[1],n=this.args[2],!(t instanceof L))throw"(Jsleri--\x3eRepeat) first argument must be an instance of Jsleri; got "+s()(t);this.element=t,this.min=void 0===e||null===e?0:e,this.max=void 0===n||null===n?null:n}b.prototype=Object.create(L.prototype),b.prototype.constructor=b,v.prototype=Object.create(L.prototype),v.prototype.constructor=v,w.prototype=Object.create(L.prototype),w.prototype.constructor=w,x.prototype=Object.create(L.prototype),x.prototype.constructor=x,O.prototype=Object.create(L.prototype),O.prototype.constructor=O;var _=function(t){if(!(t instanceof L))throw"(Jsleri--\x3eRef--\x3eset) first argument must be an instance of Jsleri; got "+s()(t);o()(this,t)};function j(t){var e=function(){};e.prototype=t.prototype;var n=L.call(this,e,arguments);if(n)return n.set=_,n}function k(t,e){var n=L.call(this,k,arguments);if(n)return n;if(t=this.args[0],e=this.args[1],!((t=void 0===t?this.constructor.START:t)instanceof L))throw"(Jsleri--\x3eOptional) first argument must be an instance of Jsleri; got "+s()(t);this.reKeywords=void 0===e?p:h(e),this.element=t,this.parse=function(e){var n=new P(this,0,e.length,e),r=y(t,e,n.children,this.reKeywords);return r.tree=n,r}}function E(t){var e=L.call(this,E,arguments);if(e)return e;if(!((t=this.args[0])instanceof L))throw"(Jsleri--\x3eRule) first argument must be an instance of Jsleri; got "+s()(t);this.element=t}function S(){var t=L.call(this,S,arguments);if(t)return t;this.elements=this.checkElements(this.args)}j.prototype=Object.create(L.prototype),j.prototype.constructor=j,k.prototype=Object.create(L.prototype),k.prototype.constructor=k,E.prototype=Object.create(L.prototype),E.prototype.constructor=E,S.prototype=Object.create(L.prototype),S.prototype.constructor=S;var J=function t(){if(!(this instanceof t))return new t};J.prototype=Object.create(L.prototype),J.prototype.constructor=J;var V=new J;function R(t){var e=L.call(this,R,arguments);if(e)return e;if("string"!=typeof(t=this.args[0]))throw"(Jsleri--\x3eToken) first argument must be a string; got "+s()(t);this.token=t}function q(t){var e=L.call(this,q,arguments);if(e)return e;if("string"!=typeof(t=this.args[0]))throw"(Jsleri--\x3eTokens) first argument must be a string; got "+s()(t);this.tokens=t.trim().split(l).sort(d)}function T(){this.e="End of statement"}R.prototype=Object.create(L.prototype),R.prototype.constructor=R,q.prototype=Object.create(L.prototype),q.prototype.constructor=q,T.prototype=Object.create(L.prototype),T.prototype.constructor=T;var C=new T;function M(t,e){this.isValid=t,this.pos=e,this.expecting=null}function P(t,e,n,r){this.element=t,this.start=e,this.end=n,this.str=r,this.children=[]}function B(){this.required=[],this.optional=[],this.pos=0,this._modes=[this.required]}function L(t,e){if(e=Array.prototype.slice.call(e),!(this instanceof t))return new(t.bind.apply(t,[t].concat(e)));this.setCallbacks(e),this.args=e}P.prototype.walk=function(){this.element.onEnter(this);for(var t=0,e=this.children.length;t<e;t++)this.children[t].walk();this.element.onExit(this)},B.prototype.setModeRequired=function(t,e){this._modes[t]!==this.optional&&(this._modes[t]=!1===e?this.optional:this.required)},B.prototype.empty=function(){this.required.length=0,this.optional.length=0},B.prototype.update=function(t,e){e>this.pos&&(this.empty(),this.pos=e),e===this.pos&&-1===this._modes[e].indexOf(t)&&this._modes[e].push(t)},B.prototype.getExpecting=function(){return this.required.concat(this.optional)},L.prototype.setCallbacks=function(t){var e=t[0];void 0===e||null===e||"string"==typeof e||e instanceof L||(f(e.onEnter)&&(this.onEnter=e.onEnter),f(e.onExit)&&(this.onExit=e.onExit),t.splice(0,1))},L.prototype.onEnter=c,L.prototype.onExit=c,L.prototype.checkElements=function(t){var e=0,n=t.length;if(0===n)throw"(Jsleri--\x3e"+this.constructor.name+") Need at least one Jsleri argument";for(;e<n;e++)t[e]instanceof L||(t[e]=new R(t[e]));return t},L.prototype.checkElement=function(t){return t instanceof L||(t=new R(t)),t}}])});